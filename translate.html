<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Multilingual Speech to PDF Translator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }
        textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: vertical;
            transition: border 0.3s;
        }
        textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            transition: all 0.3s;
            margin: 5px;
            font-weight: 600;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        button:active {
            transform: translateY(0);
        }
        .language-selector {
            margin-bottom: 15px;
        }
        select {
            padding: 8px 15px;
            font-size: 16px;
            border-radius: 6px;
            border: 2px solid #ddd;
            background: white;
            width: 100%;
            margin-bottom: 10px;
        }
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        .btn-speech {
            background: linear-gradient(to right, #2ecc71, #27ae60);
        }
        .btn-pdf {
            background: linear-gradient(to right, #e74c3c, #c0392b);
        }
        .btn-translate {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
        }
        .btn-swap {
            background: linear-gradient(to right, #f39c12, #d35400);
        }
        .btn-clear {
            background: linear-gradient(to right, #95a5a6, #7f8c8d);
        }
        .label {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            display: block;
            font-size: 16px;
        }
        .subtitle {
            color: #7f8c8d;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <h2>üéôÔ∏è Multilingual Speech ‚Üí Translation ‚Üí PDF</h2>
    
    <!-- Language Selection -->
    <div class="box">
        <div class="label">Select Speech Language:</div>
        <select id="speechLang">
            <option value="zh-CN">Chinese (‰∏≠Êñá)</option>
            <option value="ur-PK">Urdu (ÿßÿ±ÿØŸà)</option>
            <option value="en-US">English</option>
            <option value="ar-SA">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
            <option value="es-ES">Spanish (Espa√±ol)</option>
            <option value="fr-FR">French (Fran√ßais)</option>
            <option value="hi-IN">Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)</option>
            <option value="ru-RU">Russian (–†—É—Å—Å–∫–∏–π)</option>
            <option value="ja-JP">Japanese (Êó•Êú¨Ë™û)</option>
            <option value="ko-KR">Korean (ÌïúÍµ≠Ïñ¥)</option>
        </select>
        
        <div class="label">Select Translation Language:</div>
        <select id="translateLang">
            <option value="en">English</option>
            <option value="zh">Chinese (‰∏≠Êñá)</option>
            <option value="ur">Urdu (ÿßÿ±ÿØŸà)</option>
            <option value="ar">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
            <option value="es">Spanish (Espa√±ol)</option>
            <option value="fr">French (Fran√ßais)</option>
            <option value="hi">Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)</option>
            <option value="ru">Russian (–†—É—Å—Å–∫–∏–π)</option>
            <option value="ja">Japanese (Êó•Êú¨Ë™û)</option>
            <option value="ko">Korean (ÌïúÍµ≠Ïñ¥)</option>
        </select>
        <div class="subtitle">Note: Use Chrome/Edge for best speech recognition results</div>
    </div>
    
    <!-- Speech to Text -->
    <div class="box">
        <div class="label" id="sourceLabel">Source Text:</div>
        <div class="btn-group">
            <button onclick="startSpeech()" class="btn-speech">üé§ Start Speaking</button>
            <button onclick="stopSpeech()" class="btn-speech">‚èπÔ∏è Stop Recording</button>
        </div>
        <textarea id="sourceText" placeholder="Your speech will appear here..."></textarea>
    </div>
    
    <!-- Translation -->
    <div class="box">
        <div class="label" id="translatedLabel">Translated Text:</div>
        <div class="btn-group">
            <button onclick="translateText()" class="btn-translate">üåç Translate Now</button>
            <button onclick="swapLanguages()" class="btn-swap">üîÑ Swap Languages</button>
        </div>
        <textarea id="translatedText" placeholder="Translation will appear here..."></textarea>
    </div>
    
    <!-- PDF Download -->
    <div class="box">
        <div class="label">Export Options:</div>
        <div class="btn-group">
            <button onclick="downloadPDF()" class="btn-pdf">üì• Download PDF</button>
            <button onclick="clearAll()" class="btn-clear">üóëÔ∏è Clear All Text</button>
            <button onclick="copyTranslation()" class="btn-translate">üìã Copy Translation</button>
        </div>
    </div>

    <script>
        // Speech recognition variables
        let recognition;
        let isListening = false;
        
        // Language labels
        const languageLabels = {
            'zh-CN': { source: 'Chinese Text', translated: 'Translated Text' },
            'ur-PK': { source: 'Urdu Text', translated: 'Translated Text' },
            'en-US': { source: 'English Text', translated: 'Translated Text' },
            'ar-SA': { source: 'Arabic Text', translated: 'Translated Text' },
            'es-ES': { source: 'Spanish Text', translated: 'Translated Text' },
            'fr-FR': { source: 'French Text', translated: 'Translated Text' },
            'hi-IN': { source: 'Hindi Text', translated: 'Translated Text' },
            'ru-RU': { source: 'Russian Text', translated: 'Translated Text' },
            'ja-JP': { source: 'Japanese Text', translated: 'Translated Text' },
            'ko-KR': { source: 'Korean Text', translated: 'Translated Text' }
        };
        
        // üé§ Start Speech to Text
        function startSpeech() {
            if (isListening) {
                stopSpeech();
                return;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                alert("Please use Chrome or Edge browser. Speech recognition is not supported in all browsers.");
                return;
            }
            
            recognition = new SpeechRecognition();
            const speechLang = document.getElementById('speechLang').value;
            recognition.lang = speechLang;
            recognition.continuous = true;
            recognition.interimResults = true;
            
            recognition.onstart = function() {
                isListening = true;
                document.querySelector('.btn-speech').innerHTML = 'üé§ Listening... Click to Stop';
                updateLabels(speechLang);
            };
            
            recognition.onresult = function(event) {
                let transcript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        transcript += event.results[i][0].transcript + ' ';
                    }
                }
                
                if (transcript.trim()) {
                    const currentText = document.getElementById('sourceText').value;
                    document.getElementById('sourceText').value = (currentText + transcript).trim();
                }
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                if (event.error !== 'no-speech') {
                    alert("Speech recognition error: " + event.error);
                }
                stopSpeech();
            };
            
            recognition.onend = function() {
                stopSpeech();
            };
            
            try {
                recognition.start();
            } catch (e) {
                alert("Please allow microphone access: " + e.message);
            }
        }
        
        // ‚èπÔ∏è Stop Speech Recognition
        function stopSpeech() {
            if (recognition && isListening) {
                recognition.stop();
                isListening = false;
                document.querySelector('.btn-speech').innerHTML = 'üé§ Start Speaking';
            }
        }
        
        // üîÑ Swap Languages
        function swapLanguages() {
            const speechLang = document.getElementById('speechLang');
            const translateLang = document.getElementById('translateLang');
            
            // Swap language codes
            const temp = speechLang.value;
            
            // Map short codes to full language codes
            const langMap = {
                'en': 'en-US', 'zh': 'zh-CN', 'ur': 'ur-PK',
                'ar': 'ar-SA', 'es': 'es-ES', 'fr': 'fr-FR',
                'hi': 'hi-IN', 'ru': 'ru-RU', 'ja': 'ja-JP',
                'ko': 'ko-KR'
            };
            
            speechLang.value = langMap[translateLang.value] || translateLang.value + '-US';
            translateLang.value = temp.split('-')[0];
            
            // Update labels
            updateLabels(speechLang.value);
            
            // Swap text content
            const sourceText = document.getElementById('sourceText').value;
            const translatedText = document.getElementById('translatedText').value;
            
            if (sourceText && translatedText) {
                document.getElementById('sourceText').value = translatedText;
                document.getElementById('translatedText').value = sourceText;
            } else if (sourceText && !translatedText) {
                // If there's source text but no translation, translate it
                document.getElementById('translatedText').value = sourceText;
                document.getElementById('sourceText').value = '';
            }
        }
        
        // üåç Translate Text
        function translateText() {
            const sourceText = document.getElementById('sourceText').value.trim();
            
            if (!sourceText) {
                alert("Please enter or speak some text first.");
                return;
            }
            
            const sourceLang = document.getElementById('speechLang').value.split('-')[0];
            const targetLang = document.getElementById('translateLang').value;
            
            // MyMemory Translation API
            let url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(sourceText)}&langpair=${sourceLang}|${targetLang}`;
            
            document.getElementById('translatedText').value = "Translating... Please wait.";
            
            fetch(url)
                .then(res => res.json())
                .then(data => {
                    if (data.responseData && data.responseData.translatedText) {
                        document.getElementById('translatedText').value = data.responseData.translatedText;
                    } else {
                        document.getElementById('translatedText').value = "Translation failed. Please try again.";
                    }
                })
                .catch(error => {
                    console.error('Translation error:', error);
                    document.getElementById('translatedText').value = "Network error. Please check your internet connection.";
                });
        }
        
        // üìÑ Download PDF
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const sourceText = document.getElementById('sourceText').value;
            const translatedText = document.getElementById('translatedText').value;
            const sourceLang = document.getElementById('speechLang').options[document.getElementById('speechLang').selectedIndex].text;
            const targetLang = document.getElementById('translateLang').options[document.getElementById('translateLang').selectedIndex].text;
            
            // Header
            doc.setFontSize(18);
            doc.text("Multilingual Translation Document", 105, 15, null, null, 'center');
            
            doc.setFontSize(12);
            doc.text(`From: ${sourceLang} | To: ${targetLang}`, 105, 25, null, null, 'center');
            
            // Source text
            doc.setFontSize(14);
            doc.text(`Source Text (${sourceLang}):`, 10, 40);
            doc.setFontSize(11);
            const sourceLines = doc.splitTextToSize(sourceText || "No text entered", 180);
            doc.text(sourceLines, 10, 50);
            
            // Translated text
            const translatedY = 50 + (sourceLines.length * 7) + 20;
            doc.setFontSize(14);
            doc.text(`Translated Text (${targetLang}):`, 10, translatedY);
            doc.setFontSize(11);
            const translatedLines = doc.splitTextToSize(translatedText || "No translation available", 180);
            doc.text(translatedLines, 10, translatedY + 10);
            
            // Date and time
            const now = new Date();
            doc.setFontSize(10);
            doc.text(`Generated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`, 105, 280, null, null, 'center');
            
            // Watermark
            doc.setFontSize(8);
            doc.setTextColor(200, 200, 200);
            doc.text("Created with Multilingual Speech Translator", 105, 290, null, null, 'center');
            
            doc.save(`translation_${sourceLang}_to_${targetLang}_${Date.now()}.pdf`);
        }
        
        // üìã Copy Translation to Clipboard
        function copyTranslation() {
            const translatedText = document.getElementById('translatedText').value;
            
            if (!translatedText.trim()) {
                alert("No translation to copy. Please translate some text first.");
                return;
            }
            
            navigator.clipboard.writeText(translatedText)
                .then(() => {
                    alert("Translation copied to clipboard!");
                })
                .catch(err => {
                    console.error('Failed to copy: ', err);
                    alert("Failed to copy to clipboard. Please try again.");
                });
        }
        
        // üóëÔ∏è Clear All Text
        function clearAll() {
            if (confirm("Are you sure you want to clear all text?")) {
                document.getElementById('sourceText').value = '';
                document.getElementById('translatedText').value = '';
                stopSpeech();
            }
        }
        
        // Update Labels
        function updateLabels(langCode) {
            const langData = languageLabels[langCode] || { source: 'Source Text', translated: 'Translated Text' };
            document.getElementById('sourceLabel').textContent = langData.source;
            document.getElementById('translatedLabel').textContent = langData.translated;
        }
        
        // Initialize labels on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateLabels(document.getElementById('speechLang').value);
            
            // Update labels when language changes
            document.getElementById('speechLang').addEventListener('change', function() {
                updateLabels(this.value);
            });
            
            // Auto-translate when text changes (optional feature)
            document.getElementById('sourceText').addEventListener('input', function() {
                // Optional: You can enable auto-translate here
                // translateText();
            });
        });
    </script>
</body>
</html>
